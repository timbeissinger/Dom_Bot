setwd("~/Documents/DomesticationBottleneck/Dom_Bot_Git/SFS/")
sfsBKN <- exp(scan("BKN.sfs"))
sfsTIL <- exp(scan("TIL.sfs"))
barplot(sfsBKN[2:{length(sfsBKN)-1}]
barplot(sfsBKN[2:{length(sfsBKN)-1}])
barplot(sfsTIL[2:{length(sfsBKN)-1}])
barplot(sfsTIL[2:{length(sfsTIL)-1}])
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
setwd("~/Documents/DomesticationBottleneck/Dom_Bot_Git/SFS/")
dir()
2dsfs <- read.table("2dsfs.BKN.TIL.sfs")
2dsfs <- read.table("2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
2dsfs <- read.table(file="2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
2dsfs <- read.table(file="dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
dir()
2dsfs <- read.delim("2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
?read.table
dir()
2dsfs <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
q()
setwd("~/Documents/DomesticationBottleneck/Dom_Bot_Git/SFS/")
2dsfs <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
2dsfs <- read.table( "2dsf",header=F,stringsAsFactors=F)
2dsfs <- read.table("2dsf",header=F,stringsAsFactors=F)
2dsfs <- read.table("sf",header=F,stringsAsFactors=F)
dir()
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
2dsfs
sfs2d
heatmap(sfs2d)
sfs2d.mat <- exp(as.matrix(sfs2d))
sfs2d.mat
heatmap(sfs2d.mat)
heatmap(sfs2d.mat,Rowv=NA,colv=NA)
heatmap(sfs2d.mat,Rowv=NA)
heatmap(sfs2d.mat,Rowv=NA,Colv=NA)
heatmap(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=NA,Colv=NA)
install.packages("gplots")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=NA,Colv=NA)
library(gplots)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=NA,Colv=NA)
?heatmap.2
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F)
?heatmap.2
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none")
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none")
sfs2d.mat[1:5,1:5]
sfs2d.mat[10:15,10:15]
sfs2d.mat <- as.matrix(sfs2d)
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none")
sfs2d.mat <- exp(as.matrix(sfs2d))
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none",density.info="none")
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none",density.info="none",trace="none")
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv=F,dendrogram="none",density.info="none",trace="none",Colv="NA")
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none")
sfsBKN <- exp(scan("BKN.sfs"))
sfsTIL <- exp(scan("TIL.sfs"))
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)

pdf("SFS_Plots_individual_pops.pdf")
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
dev.off()

?heatmap.2
heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col="rainbow")
col_breaks = c(seq(-1,0,length=100),  # for red
  seq(0,0.8,length=100),              # for yellow
  seq(0.8,1,length=100))              # for green

heatmap.2(sfs2d.mat[3:{nrow(sfs2d.mat)-1},3:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=col_breaks)
sfs2d.mat <- exp(as.matrix(sfs2d))
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=col_breaks)
col_breaks = c(seq(0,0.01,length=100),  # for red
  seq(0.01,0.05,length=100),              # for yellow
  seq(0.05,1,length=100))              # for green

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=col_breaks)
col_breaks = c(seq(0,0.001,length=100),  # for red
  seq(0.001,0.01,length=100),              # for yellow
  seq(0.01,1,length=100))              # for green

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=col_breaks)
my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)
col_breaks = c(seq(0,0.001,length=100),  # for red
  seq(0.001,0.01,length=100),              # for yellow
  seq(0.01,1,length=100))              # for green

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_pallette, breaks=col_breaks)
my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_pallette, breaks=col_breaks)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)

col_breaks = c(seq(0,0.00001,length=100),  # for red
  seq(0.00001,0.0001,length=100),              # for yellow
  seq(0.0001,1,length=100))              # for green

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("green", "yellow", "red"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("black", "yellow", "red"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("white", "yellow", "red"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("green", "red", "yellow"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
col_breaks = c(seq(0,0.00001,length=100),  # for green
  seq(0.00001,0.0001,length=100),              # for red
  seq(0.0001,0.01,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("green", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.0001,length=100),  # for green
  seq(0.0001,0.001,length=100),              # for red
  seq(0.001,0.01,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks)
?heatmap.2
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=F)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T)
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.0005,length=100),  # for blue
  seq(0.0005,0.001,length=100),              # for red
  seq(0.001,0.01,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T)
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.001,length=100),              # for red
  seq(0.001,0.01,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T)
?heatmap.2
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=2)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
?heatmap.2
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
?heatmap.2
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1,lmat=rbind( c(0, 3), c(2,1), c(0,4) ))
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1,lmat=rbind( c(0, 3), c(2,1), c(0,4) ))
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow


my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1,lmat=rbind( c(0, 3), c(2,1), c(0,4) ),lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 4, 2 ) )
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 4, 2 ) )
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 4, 2 ) )
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow


heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1, 4, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 2, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 6, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 1 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 3 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 1 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 6, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 2, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 2, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 2, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ) )
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ) main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(1,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 2), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 4), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(1,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 10, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)")
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab=="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 6, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab=="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 4, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab=="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab=="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
?heatmap.2
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1, lhei=c(2, 8, 2 ))
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1, lhei=c(2, 8 ))
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
pdf("BKN-TIL-2d-sfs.pdf")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (1-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
dev.off()
pdf("BKN-TIL-2d-sfs.pdf")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (0-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
dev.off()
q()
dir()
dir("..")
dir("../SFS")
sfsInb <- exp(scan("../SFS/BKN.sfs"))
sfsNoInb <- exp(scan("../SFS/BKN_no_inb.sfs"))
sfsInb
sfsNoInb
sfsInb - sfsNoInb
sfsInb <- exp(scan("../SFS/BKN.sfs"))
sfsNoInb <- exp(scan("../SFS/BKN_no_inb.sfs"))
sfsInb - sfsNoInb # identical...
barplot(sfsInb)
barplot(sfsInb[-c(0,length(sfsInb)])
barplot(sfsInb[-c(0,length(sfsInb))])
barplot(sfsInb[-c(1,length(sfsInb))])
pdf("BKN.Inbreeding.Correct.pdf")
barplot(sfsInb[-c(1,length(sfsInb))])
dev.off()
barplot(sfsInb[-c(1,length(sfsInb))])
axis(1,1:39)
barplot(sfsInb[-c(1,length(sfsInb))],labels=1:39)
barplot(sfsInb[-c(1,length(sfsInb))],xaxt=1:39)
?barplot
barplot(sfsInb[-c(1,length(sfsInb))],names.arg=1:39)
pdf("BKN.Inbreeding.Correct.pdf")
barplot(sfsInb[-c(1,length(sfsInb))],names.arg=1:39)
dev.off()
pdf("../SFS/BKN.Inbreeding.Correct.pdf")
barplot(sfsInb[-c(1,length(sfsInb))],names.arg=1:39)
dev.off()
q()
setwd("~/Documents/DomesticationBottleneck/Dom_Bot_Git/SFS/")
getwd()
setwd("~/Documents/DomesticationBottleneck/Dom_Bot/SFS/")
getwd()
library(gplots)
sfsBKN <- exp(scan("BKN.sfs"))
sfsTIL <- exp(scan("TIL.sfs"))
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
sfs2d.mat <- exp(as.matrix(sfs2d))
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)
col_breaks = c(seq(0,0.00005,length=100),  # for blue
  seq(0.00005,0.0001,length=100),              # for red
  seq(0.0001,0.001,length=100))              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (0-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
sfsBKN <- exp(scan("BKN.sfs"))*10000000
sfsTIL <- exp(scan("TIL.sfs"))*10000000
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)*10000000
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
sfs2d.mat <- exp(as.matrix(sfs2d))
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)
col_breaks = c(seq(0,0.00005,length=100)*10000000,  # for blue
  seq(0.00005,0.0001,length=100)*10000000,              # for red
  seq(0.0001,0.001,length=100)*10000000)              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (0-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
col <- breaks
col_breaks
nrow(2dsfs.mat)
nrow(sfs2d.mat)
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)*10000000
sfs2d
hist(sfs2d)
hist(sfs2d.mat)
max(sfs2d.mat)
min(sfs2d.mat)
sfs2d.mat <- exp(as.matrix(sfs2d))
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
hist(sfs2d.mat)
sfs2d
sfs2d <- read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F)*10000000
sfs2d.mat <- exp(as.matrix(sfs2d))
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
sfs2d.mat
sfs2d.mat <- exp(as.matrix(sfs2d))
sfs2d.mat
sfs2d
sfs2d <- exp(read.table( "2dsfs.BKN.TIL.sfs",header=F,stringsAsFactors=F))*10000000
sfs2d
sfs2d.mat <- as.matrix(sfs2d)
sfs2d.mat
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (0-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
sfs2d <- exp(read.table( "2dsfs.TIL.BKN.sfs",header=F,stringsAsFactors=F))*10000000
sfs2d.mat <- as.matrix(sfs2d)
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)
hits(2dsfs.mat)
hist(2dsfs.mat)
hist(sfs2d.mat)

setwd("~/Documents/DomesticationBottleneck/Dom_Bot/SFS/")

library(gplots)

sfsBKN <- exp(scan("BKN.sfs"))*10000000
sfsTIL <- exp(scan("TIL.sfs"))*10000000
sfs2d <- exp(read.table( "2dsfs.TIL.BKN.sfs",header=F,stringsAsFactors=F))*10000000

pdf("SFS_Plots_individual_pops.pdf")
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
dev.off()

sfs2d.mat <- as.matrix(sfs2d)
rownames(sfs2d.mat) <- 0:{nrow(sfs2d.mat)-1}
colnames(sfs2d.mat) <- 0:{ncol(sfs2d.mat)-1}

my_palette <- colorRampPalette(c("blue", "red", "yellow"))(n = 299)

col_breaks = c(seq(0,0.00005,length=100)*10000000,  # for blue
  seq(0.00005,0.0001,length=100)*10000000,              # for red
  seq(0.0001,0.001,length=100)*10000000)              # for yellow

heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=1)

pdf("TIL-BKN-2d-sfs.pdf")
heatmap.2(sfs2d.mat[2:{nrow(sfs2d.mat)-1},2:{ncol(sfs2d.mat)-1}],Rowv=F,Colv="NA",dendrogram="none",density.info="none",trace="none",col=my_palette, breaks=col_breaks,revC=T,keysize=0.5,lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(2, 8, 2 ), main="2d sfs for teo & landraces (0-10MB on chr 10)",xlab="No. Teosinte chromosomes with derived allele",ylab="No. Landrace chromosomes with derived allele")
dev.off()

q()

sfs <- exp(read.table("../SFS/2dsfs.TIL.BKN.sfs"))*10000000 #we calculated 10 MB of DNA
sfs <- sfs[seq(1,nrow(sfs),2),seq(1,ncol(sfs),2)]

n1=nrow(sfs);
n2=ncol(sfs);
ns=paste(n1,n2,collapse=' ');
ns=paste(ns,"unfolded",collapse=' ');

dadi=NULL;
for(i in 1:n1){
	dadi=c(dadi,as.numeric(sfs[i,]))
}

write.table(ns,file="../SFS/2d_BKN_TIL.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE);
write.table(paste(dadi,collapse=' '),file="../SFS/2d_BKN_TIL.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE,append=TRUE);


sfsBKN <- exp(scan("../SFS/BKN.sfs"))*10000000 #we calculated 10 MB of DNA
sfsBKN <- sfsBKN[seq(1,length(sfsBKN),2)] # treat as sample from haploid
sfsBKNdadi <- matrix(nrow=2,ncol=1)
sfsBKNdadi[1,1] <- paste(length(sfsBKN), "unfolded",sep=" ")
sfsBKNdadi[2,1] <- paste(sfsBKN,collapse=" ")
write.table(sfsBKNdadi,file="../SFS/sfsBKN.dadi",quote=F,row.names=F,col.names=F)

sfsTIL <- exp(scan("../SFS/TIL.sfs"))*10000000 #we calculated 10 MB of DNA
sfsTIL <- sfsTIL[seq(1,length(sfsTIL),2)] # treat as sample from haploid
sfsTILdadi <- matrix(nrow=2,ncol=1)
sfsTILdadi[1,1] <- paste(length(sfsTIL), "unfolded",sep=" ")
sfsTILdadi[2,1] <- paste(sfsTIL,collapse=" ")
write.table(sfsTILdadi,file="../SFS/sfsTIL.dadi",quote=F,row.names=F,col.names=F)


sfs <- exp(read.table("../SFS/2dsfs.TIL.BKN.sfs"))*10000000 #we calculated 10 MB of DNA
sfs <- sfs[seq(1,nrow(sfs),2),seq(1,ncol(sfs),2)]

n1=nrow(sfs);
n2=ncol(sfs);
ns=paste(n1,n2,collapse=' ');
ns=paste(ns,"unfolded",collapse=' ');

dadi=NULL;
for(i in 1:n1){
	dadi=c(dadi,as.numeric(sfs[i,]))
}

write.table(ns,file="../SFS/2d_BKN_TIL.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE);
write.table(paste(dadi,collapse=' '),file="../SFS/2d_BKN_TIL.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE,append=TRUE);


sfs <- exp(read.table("../SFS/2dsfs.TIL.BKN.sfs"))*10000000 #we calculated 10 MB of DNA
sfs <- sfs[seq(1,nrow(sfs),2),seq(1,ncol(sfs),2)]

n1=nrow(sfs);
n2=ncol(sfs);
ns=paste(n1,n2,collapse=' ');
ns=paste(ns,"unfolded",collapse=' ');

dadi=NULL;
for(i in 1:n1){
	dadi=c(dadi,as.numeric(sfs[i,]))
}

write.table(ns,file="../SFS/2d_TIL_BKN.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE);
write.table(paste(dadi,collapse=' '),file="../SFS/2d_TIL_BKN.dadi",col.names=FALSE,row.names=FALSE,quote=FALSE,append=TRUE);


q()
setwd("~/Documents/DomesticationBottleneck/Dom_Bot/SFS/")
sfsBKN <- exp(scan("BKN.sfs"))*10000000
sfsTIL <- exp(scan("TIL.sfs"))*10000000

sfsBKN <- exp(scan("BKN.sfs"))*10000000
sfsBKN <- exp(scan("BKN.sfs"))*10000000
sfsTIL <- exp(scan("TIL.sfs"))*10000000
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
pdf("SFS_Plots_individual_pops.pdf")
barplot(sfsBKN[2:{length(sfsBKN)-1}],main="Landrace SFS")
barplot(sfsTIL[2:{length(sfsTIL)-1}],main="Teosinte SFS")
dev.off()

q()
